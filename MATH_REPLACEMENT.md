# bc依赖替换说明

## 概述

本项目已完全移除对`bc`计算器的依赖，改为使用纯Bash实现的数学运算函数。所有数学运算现在都在`lib/bash_math.sh`库中实现。

## 替换的函数

### 十六进制与十进制转换
- **原bc命令**: `echo "obase=16; $dec" | bc`
- **新Bash函数**: `bashmath_dec_to_hex "$dec"`

- **原bc命令**: `echo "ibase=16; $hex" | bc`
- **新Bash函数**: `bashmath_hex_to_dec "$hex"`

### 对数计算
- **原bc命令**: `echo "l($n)/l(2)" | bc -l`
- **新Bash函数**: `bashmath_log2 "$n"`

### 浮点数除法
- **原bc命令**: `echo "$a / $b" | bc -l`
- **新Bash函数**: `bashmath_divide_float "$a" "$b" [精度]`

### 二进制转换
- **原bc命令**: `echo "obase=2; $dec" | bc`
- **新Bash函数**: `bashmath_dec_to_binary "$dec"`

## 性能影响

纯Bash实现的数学运算相比bc计算器可能有轻微的性能下降，但优势在于：

1. **零外部依赖**: 不再需要安装bc包
2. **更好的可移植性**: 在任何支持Bash的环境中都可以运行
3. **安全性**: 减少了外部命令注入的风险
4. **一致性**: 所有运算都在Bash环境中执行

## 测试

新的数学函数库包含了完整的测试用例，可以通过以下方式验证：

```bash
bash lib/bash_math.sh
```

这将运行所有数学函数的测试并显示结果。

## 兼容性

- 需要Bash 4.0或更高版本
- 支持大数运算（受限于Bash的整数范围）
- 对于特别大的数字，仍使用bigint.sh库中的分块算法

## 实现细节

数学函数库使用纯Bash的内置算术运算实现：
- 使用`$(( ))`进行整数运算
- 使用字符串操作处理大数
- 使用循环和条件判断实现复杂算法
- 支持负数处理和精度控制

所有函数都具有错误处理机制，对于无效输入会返回适当的错误值。