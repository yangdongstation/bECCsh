# bECCsh 项目外部依赖映射表

## 按文件分类的依赖分析

### 主程序文件

#### `becc.sh` (主程序)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `date` | 64 | 日志时间戳 | ✅ |
| `base64` | 321, 353 | 签名编解码 | ✅ |
| `cat` | 286, 364 | 文件读取 | ✅ |

#### `core/becc_pure.sh` (纯Bash版本)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `source` | 15 | 加载纯Bash模块 | ✅ |

### 核心库文件

#### `lib/ecdsa.sh` (ECDSA实现)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `sha256sum` | 92-93 | SHA256哈希 | ✅ |
| `shasum` | 94-95, 104-105, 114-115 | 备选哈希 | ❌ |
| `sha384sum` | 103-104 | SHA384哈希 | ✅ |
| `sha512sum` | 113-114 | SHA512哈希 | ✅ |
| `cut` | 134, 200-201, 306-309, 335-336, 431-432 | 文本分割 | ✅ |
| `tr` | 134 | 字符处理 | ✅ |

#### `lib/security.sh` (安全功能)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `openssl` | 28, 32 | HMAC计算 | ❌ |
| `sha256sum` | 34, 43 | 哈希计算 | ✅ |
| `shasum` | 45 | 备选哈希 | ❌ |
| `cut` | 28, 30, 34, 43, 45 | 文本处理 | ✅ |
| `printf` | 136-137, 214 | 格式化输出 | ✅ |
| `tr` | 136-137 | 字符转换 | ✅ |

#### `lib/entropy.sh` (熵收集系统)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `date` | 57 | 时间戳 | ✅ |
| `uptime` | 67 | 系统负载 | ✅ |
| `awk` | 67 | 文本处理 | ✅ |
| `tr` | 67, 143, 315-322 | 字符处理 | ✅ |
| `grep` | 68, 76, 85, 94, 120 | 文本搜索 | ✅ |
| `cut` | 68, 76, 85, 315-322 | 文本分割 | ✅ |
| `md5sum` | 68, 76, 85, 94, 107, 315-322 | 哈希计算 | ✅ |
| `cat` | 76, 77, 78, 85, 94, 95, 107, 120, 143 | 文件读取 | ✅ |
| `head` | 77, 78, 107, 120, 143 | 文件头处理 | ✅ |
| `find` | 95 | 文件查找 | ✅ |
| `xargs` | 95 | 命令组合 | ✅ |
| `tail` | 107 | 文件尾处理 | ✅ |
| `xxd` | 143 | 十六进制转换 | ✅ |
| `sha256sum` | 218, 249 | 熵混合 | ✅ |

#### `lib/bigint.sh` (大数运算)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `openssl` | 675 | 随机数生成 | ❌ |
| `head` | 675-676 | 随机数据读取 | ✅ |
| `xxd` | 675-676 | 十六进制转换 | ✅ |
| `cut` | 636, 652 | 文本分割 | ✅ |

#### `lib/ec_curve.sh` (椭圆曲线参数)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `cut` | 128-134 | 参数解析 | ✅ |

#### `lib/ec_point.sh` (椭圆曲线点运算)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `bigint_subtract` | 98, 99, 112, 115, 158, 161 | 大数减法 | ✅ |
| `bigint_add` | 112, 115, 158, 161 | 大数加法 | ✅ |
| `bigint_multiply` | 115, 158, 161 | 大数乘法 | ✅ |

#### `lib/bash_simple_ec.sh` (简化EC实现)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `cut` | 258-259 | 签名解析 | ✅ |
| `printf` | 164 | ASCII转换 | ✅ |

#### `lib/bash_ec_math.sh` (EC数学运算)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `cut` | 185-186, 195-196, 286, 293, 308 | 坐标提取 | ✅ |
| `bashbigint_subtract` | 58, 61, 64, 74, 75, 91, 94, 135, 138 | 大数运算 | ✅ |
| `bashbigint_add` | 64, 75, 91, 94, 135, 138 | 大数运算 | ✅ |
| `bashbigint_multiply` | 94, 135, 138 | 大数运算 | ✅ |

#### `lib/bash_bigint.sh` (纯Bash大数运算)
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `cut` | 478-480, 503 | 运算结果解析 | ✅ |
| `bashbigint_subtract` | 483, 641 | 大数运算 | ✅ |
| `bashbigint_multiply` | 641 | 大数运算 | ✅ |
| `bashbigint_divide` | 641 | 大数运算 | ✅ |

### 对比测试文件（大量外部依赖）

#### `openssl_comparison_test.sh`
| 依赖命令 | 使用行数 | 用途 | 是否必需 |
|---------|---------|------|----------|
| `openssl` | 44, 64, 95, 110, 127, 170, 202, 232, 236 | 对比基准 | ❌ |
| `base64` | 96, 110, 127 | Base64编码 | ✅ |
| `hexdump` | 171, 180, 203 | 十六进制显示 | ✅ |
| `stat` | 183-184 | 文件状态 | ✅ |
| `grep` | 236, 251 | 文本搜索 | ✅ |
| `sed` | 236, 251 | 文本替换 | ✅ |
| `wc` | 209, 216, 217 | 字符统计 | ✅ |
| `bc` | 221, 222 | 数学计算 | ✅ |
| `shasum` | 46 | 哈希检查 | ❌ |
| `sha256sum` | 46 | 哈希检查 | ✅ |
| `xxd` | 46 | 十六进制检查 | ✅ |
| `tr` | 203 | 字符处理 | ✅ |
| `cat` | 171, 180 | 文件读取 | ✅ |

## 依赖强度分析

### 🔴 强依赖（无法运行）
- `cut` - 文本分割（出现100+次）
- `tr` - 字符转换（出现50+次）
- `sha256sum/sha384sum/sha512sum` - 哈希计算（密码学核心）
- `base64` - 编码转换（密钥和签名处理）

### 🟡 中等依赖（功能受限）
- `date` - 时间戳（日志功能）
- `cat` - 文件读取（输入处理）
- `head/tail` - 文件处理（熵收集）
- `grep` - 文本搜索（系统信息收集）

### 🟢 弱依赖（有备选方案）
- `openssl` - 有纯Bash备选
- `shasum` - 有sha*sum备选
- `xxd/hexdump` - 有基本功能备选

## 零依赖实现难度评估

### 高难度（需要完全重写）
1. **哈希函数** - 需要实现SHA256/384/512纯Bash版本
2. **Base64编解码** - 需要完整实现Base64算法
3. **文本分割** - 需要替代cut命令的所有功能

### 中等难度（需要部分重写）
1. **系统信息收集** - 减少对/proc和系统工具的依赖
2. **十六进制转换** - 实现二进制和十六进制互转
3. **文件处理** - 减少对head/tail的依赖

### 低难度（简单替换）
1. **时间戳** - 可用Bash内置变量替代
2. **字符转换** - 可用Bash参数扩展替代
3. **基本输出** - 可用Bash内置命令

---

**总计发现的依赖命令**: 20+ 种  
**依赖出现总次数**: 500+ 次  
**强依赖比例**: 约60%  
**零依赖实现可行性**: 低（需要大量重写工作）