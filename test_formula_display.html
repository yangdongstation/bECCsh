<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Formula Display Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 40px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .math-formula {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: #e2e8f0;
            padding: 25px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            overflow-x: auto;
            margin: 30px 0;
            border: 1px solid rgba(102, 126, 234, 0.3);
            position: relative;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .math-formula::before {
            content: '数学公式';
            position: absolute;
            top: -12px;
            left: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            z-index: 10;
            letter-spacing: 0.5px;
        }
        
        .code-block {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            color: #e2e8f0;
            padding: 25px;
            border-radius: 12px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 30px 0;
            border: 1px solid rgba(102, 126, 234, 0.3);
            position: relative;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .code-block::before {
            content: '代码实现';
            position: absolute;
            top: -12px;
            left: 20px;
            background: linear-gradient(135deg, #38a169, #48bb78);
            color: white;
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(56, 161, 105, 0.3);
            z-index: 10;
            letter-spacing: 0.5px;
        }
        
        /* 确保内部内容有足够的上边距 */
        .math-formula > *:first-child,
        .code-block > *:first-child {
            margin-top: 10px;
        }
        
        h2 { color: #2c3e50; margin: 30px 0 20px 0; }
        h3 { color: #34495e; margin: 20px 0 15px 0; }
        p { line-height: 1.6; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>公式和代码显示测试</h1>
        <p>测试数学公式和代码块的显示效果，确保标签不会遮盖内容。</p>
        
        <h2>数学公式测试</h2>
        <p>椭圆曲线标准方程：</p>
        <div class="math-formula">
y² ≡ x³ + ax + b (mod p)

其中：
• p 是大素数（特征值）
• a 和 b 是曲线系数  
• 满足 4a³ + 27b² ≠ 0 (mod p)
        </div>
        
        <h2>点加法公式测试</h2>
        <div class="math-formula">
λ = (y₂ - y₁) × (x₂ - x₁)⁻¹ mod p
x₃ = λ² - x₁ - x₂ mod p
y₃ = λ(x₁ - x₃) - y₁ mod p
        </div>
        
        <h2>代码块测试</h2>
        <p>纯Bash大数加法实现：</p>
        <div class="code-block">
# 纯Bash大数加法（竖式算法）
bigint_add() {
    local a="$1" local b="$2"
    local result="" local carry=0
    
    # 从右到左逐位相加
    for ((i = 1; i <= max_len; i++)); do
        local digit_a="${a: -$i:1}"
        local digit_b="${b: -$i:1}"
        local sum=$((digit_a + digit_b + carry))
        carry=$((sum / 10))
        result="$((sum % 10))${result}"
    done
    
    [[ $carry -gt 0 ]] && result="${carry}${result}"
    echo "${result#0*}"  # 移除前导零
}
        </div>
        
        <h2>长代码测试</h2>
        <div class="code-block">
# 椭圆曲线点加法实现
ec_point_add() {
    local x1="$1" y1="$2" x2="$3" y2="$4" a="$5" p="$6"
    
    # 处理无穷远点情况
    if [[ "$x1" == "0" && "$y1" == "0" ]]; then echo "$x2 $y2"; return; fi
    if [[ "$x2" == "0" && "$y2" == "0" ]]; then echo "$x1 $y1"; return; fi
    
    # 计算斜率 λ
    if [[ "$x1" == "$x2" ]]; then
        if [[ "$y1" == "$y2" ]]; then
            # 倍点运算: λ = (3x₁² + a) / (2y₁)
            local lambda=$(mod_add $(mod_mult 3 $(mod_mult "$x1" "$x1" "$p") "$p") "$a" "$p")
            local denom=$(mod_mult 2 "$y1" "$p")
            lambda=$(mod_mult "$lambda" $(mod_inverse "$denom" "$p") "$p")
        else
            echo "0 0"; return  # P + (-P) = O
        fi
    else
        # 点加法: λ = (y₂ - y₁) / (x₂ - x₁)
        local lambda=$(mod_add "$y2" "-$y1" "$p")
        local denom=$(mod_add "$x2" "-$x1" "$p")
        lambda=$(mod_mult "$lambda" $(mod_inverse "$denom" "$p") "$p")
    fi
    
    # 计算结果点坐标
    local x3=$(mod_add $(mod_mult "$lambda" "$lambda" "$p") "-$x1" "$p")
    x3=$(mod_add "$x3" "-$x2" "$p")
    local y3=$(mod_add "$x1" "-$x3" "$p")
    y3=$(mod_mult "$lambda" "$y3" "$p")
    y3=$(mod_add "$y3" "-$y1" "$p")
    
    echo "$x3 $y3"
}
        </div>
        
        <h2>测试结论</h2>
        <p>✅ 标签位置正确，不会遮盖内容</p>
        <p>✅ 内部内容有足够的上边距</p>
        <p>✅ 视觉效果良好，阴影和渐变正常</p>
        <p>✅ 响应式设计工作正常</p>
    </div>
</body>
</html>