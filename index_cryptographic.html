<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bECCsh å¯†ç å­¦æŠ€æœ¯å±•ç¤º - æ¤­åœ†æ›²çº¿ç®—æ³•è¯¦è§£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #2d3748;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            padding: 60px 0;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #fff, #64b5f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header .subtitle {
            font-size: 1.6em;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .header .tagline {
            font-size: 1.2em;
            opacity: 0.8;
        }
        
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .section {
            padding: 40px;
            border-bottom: 1px solid rgba(30, 60, 114, 0.1);
        }
        
        .section h2 {
            color: #1e3c72;
            font-size: 2.2em;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
        }
        
        .section h2::before {
            content: '';
            width: 6px;
            height: 35px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            margin-right: 20px;
            border-radius: 3px;
        }
        
        .math-derivation {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid #1e3c72;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            font-family: 'Times New Roman', serif;
        }
        
        .math-derivation .formula {
            font-size: 1.2em;
            margin: 10px 0;
            text-align: center;
            color: #2d3748;
        }
        
        .math-derivation .derivation-step {
            margin: 15px 0;
            padding-left: 20px;
            border-left: 2px solid #dee2e6;
        }
        
        .algorithm-box {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: #e2e8f0;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        
        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .parameter-table th,
        .parameter-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .parameter-table th {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            font-weight: 600;
        }
        
        .crypto-formula {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
        }
        
        .step-by-step {
            counter-reset: step-counter;
        }
        
        .step {
            counter-increment: step-counter;
            background: white;
            border-left: 4px solid #1e3c72;
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .step::before {
            content: counter(step-counter);
            background: #1e3c72;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .highlight-box {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #1e3c72;
        }
        
        .warning-box {
            background: linear-gradient(120deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #e17055;
        }
        
        .success-box {
            background: linear-gradient(120deg, #a8e6cf 0%, #dcedc8 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #388e3c;
        }
        
        .navigation {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(30, 60, 114, 0.9);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }
        
        .navigation a {
            color: white;
            text-decoration: none;
            display: block;
            margin: 5px 0;
            font-size: 0.9em;
            transition: color 0.3s ease;
        }
        
        .navigation a:hover {
            color: #64b5f6;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2.5em; }
            .section { padding: 20px; }
            .navigation { display: none; }
        }
    </style>
</head>
<body>
    <nav class="navigation">
        <strong>å¿«é€Ÿå¯¼èˆª</strong>
        <a href="#elliptic-curve-math">æ¤­åœ†æ›²çº¿æ•°å­¦</a>
        <a href="#ecdsa-algorithm">ECDSAç®—æ³•</a>
        <a href="#bash-implementation">Bashå®ç°</a>
        <a href="#curve-parameters">æ›²çº¿å‚æ•°</a>
        <a href="#security-features">å®‰å…¨ç‰¹æ€§</a>
        <a href="#demo">è¿è¡Œæ¼”ç¤º</a>
    </nav>

    <div class="container">
        <header class="header">
            <h1>bECCsh å¯†ç å­¦æŠ€æœ¯</h1>
            <div class="subtitle">æ¤­åœ†æ›²çº¿å¯†ç å­¦ç®—æ³•è¯¦è§£ä¸çº¯Bashå®ç°</div>
            <div class="tagline">ä»é›¶å¼€å§‹ç†è§£å¯†ç å­¦æœ¬è´¨ | å®Œå…¨é€æ˜çš„ç®—æ³•å®ç°</div>
        </header>
        
        <div class="main-content">
            <section class="section" id="elliptic-curve-math">
                <h2>ğŸ“ æ¤­åœ†æ›²çº¿æ•°å­¦åŸºç¡€</h2>
                
                <h3>1.1 æ¤­åœ†æ›²çº¿å®šä¹‰</h3>
                <div class="math-derivation">
                    <div class="formula">
                        <strong>æ ‡å‡†é­å°”æ–¯ç‰¹æ‹‰æ–¯æ–¹ç¨‹ï¼š</strong><br>
                        yÂ² â‰¡ xÂ³ + ax + b (mod p)
                    </div>
                    
                    <div class="derivation-step">
                        <strong>å‚æ•°è¯´æ˜ï¼š</strong>
                        <ul>
                            <li><strong>p</strong>ï¼šå¤§ç´ æ•°æ¨¡æ•°ï¼Œå®šä¹‰æœ‰é™åŸŸ GF(p)</li>
                            <li><strong>a, b</strong>ï¼šæ›²çº¿ç³»æ•°ï¼Œæ»¡è¶³ 4aÂ³ + 27bÂ² â‰  0 (mod p)</li>
                            <li><strong>O</strong>ï¼šæ— ç©·è¿œç‚¹ï¼Œç¾¤çš„å•ä½å…ƒ</li>
                        </ul>
                    </div>
                    
                    <div class="derivation-step">
                        <strong>å‡ ä½•æ„ä¹‰ï¼š</strong>
                        æ¤­åœ†æ›²çº¿æ˜¯ä¸‰æ¬¡å¹³é¢æ›²çº¿ï¼Œå…¶ä¸Šçš„ç‚¹æ„æˆé˜¿è´å°”ç¾¤ï¼Œè¿™ä¸ªç¾¤çš„æ€§è´¨ä½¿å¾—å®ƒéå¸¸é€‚åˆå¯†ç å­¦åº”ç”¨ã€‚
                    </div>
                </div>

                <h3>1.2 æœ‰é™åŸŸè¿ç®—</h3>
                <div class="parameter-table">
                    <table>
                        <thead>
                            <tr>
                                <th>è¿ç®—ç±»å‹</th>
                                <th>æ•°å­¦å®šä¹‰</th>
                                <th>Bashå®ç°</th>
                                <th>å¤æ‚æ€§</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>æ¨¡åŠ æ³•</td>
                                <td>(a + b) mod p</td>
                                <td>$(( (a + b) % p ))</td>
                                <td>ç®€å•</td>
                            </tr>
                            <tr>
                                <td>æ¨¡ä¹˜æ³•</td>
                                <td>(a Ã— b) mod p</td>
                                <td>éœ€è¦å¤§æ•°æ”¯æŒ</td>
                                <td>ä¸­ç­‰</td>
                            </tr>
                            <tr>
                                <td>æ¨¡é€†å…ƒ</td>
                                <td>aâ»Â¹ mod p</td>
                                <td>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</td>
                                <td>å¤æ‚</td>
                            </tr>
                            <tr>
                                <td>æ¨¡å¹‚è¿ç®—</td>
                                <td>aáµ‡ mod p</td>
                                <td>å¹³æ–¹ä¹˜ç®—æ³•</td>
                                <td>å¤æ‚</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>1.3 æ¤­åœ†æ›²çº¿ç¾¤è¿ç®—</h3>
                
                <h4>ç‚¹åŠ æ³•ç®—æ³•</h4>
                <div class="step-by-step">
                    <div class="step">
                        <strong>è¾“å…¥ï¼š</strong>ä¸¤ç‚¹ P(xâ‚, yâ‚) å’Œ Q(xâ‚‚, yâ‚‚)ï¼Œæ›²çº¿å‚æ•° a, p
                    </div>
                    
                    <div class="step">
                        <strong>ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š</strong>
                        <ul>
                            <li>è‹¥ P = Oï¼Œè¿”å› Q</li>
                            <li>è‹¥ Q = Oï¼Œè¿”å› P</li>
                            <li>è‹¥ xâ‚ = xâ‚‚ ä¸” yâ‚ = -yâ‚‚ mod pï¼Œè¿”å› O</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—æ–œç‡ Î»ï¼š</strong>
                        <div class="crypto-formula">
                            å¦‚æœ P â‰  Q: Î» = (yâ‚‚ - yâ‚) Ã— (xâ‚‚ - xâ‚)â»Â¹ mod p<br>
                            å¦‚æœ P = Q: Î» = (3xâ‚Â² + a) Ã— (2yâ‚)â»Â¹ mod p
                        </div>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—ç»“æœç‚¹ R(xâ‚ƒ, yâ‚ƒ)ï¼š</strong>
                        <div class="crypto-formula">
                            xâ‚ƒ = Î»Â² - xâ‚ - xâ‚‚ mod p<br>
                            yâ‚ƒ = Î»(xâ‚ - xâ‚ƒ) - yâ‚ mod p
                        </div>
                    </div>
                </div>

                <h4>æ ‡é‡ä¹˜æ³•ç®—æ³•</h4>
                <div class="algorithm-box">
# åŒå€åŠ æ³•ç®—æ³• (Double-and-Add)
function scalar_multiply(k, P):
    result = O  # æ— ç©·è¿œç‚¹
    current = P
    
    while k > 0:
        if k mod 2 == 1:
            result = point_add(result, current)
        current = point_add(current, current)  # å€ç‚¹
        k = k // 2
    
    return result
                </div>
            </section>
            
            <section class="section" id="ecdsa-algorithm">
                <h2>ğŸ” ECDSA æ•°å­—ç­¾åç®—æ³•</h2>
                
                <h3>2.1 ç®—æ³•å‚æ•°</h3>
                <div class="highlight-box">
                    <strong>åŸŸå‚æ•°ï¼š</strong> p, a, b, G, n, h<br>
                    <strong>ç§é’¥ï¼š</strong> éšæœºæ•´æ•° d âˆˆ [1, n-1]<br>
                    <strong>å…¬é’¥ï¼š</strong> ç‚¹ Q = d Ã— G<br>
                    <strong>åŸºç‚¹ï¼š</strong> G = (Gâ‚“, Gáµ§)ï¼Œé˜¶ä¸º n
                </div>

                <h3>2.2 ç­¾åç”Ÿæˆè¿‡ç¨‹</h3>
                <div class="step-by-step">
                    <div class="step">
                        <strong>è¾“å…¥ï¼š</strong>æ¶ˆæ¯ mï¼Œç§é’¥ dï¼ŒåŸŸå‚æ•°
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—æ¶ˆæ¯å“ˆå¸Œï¼š</strong>
                        <div class="crypto-formula">e = HASH(m)</div>
                        <p>å…¶ä¸­ HASH æ˜¯å¯†ç å­¦å“ˆå¸Œå‡½æ•°ï¼ˆå¦‚ SHA-256ï¼‰</p>
                    </div>
                    
                    <div class="step">
                        <strong>ç”Ÿæˆéšæœºæ•°ï¼š</strong>
                        <div class="crypto-formula">k âˆˆ [1, n-1]</div>
                        <p>ä½¿ç”¨ RFC 6979 ç¡®å®šæ€§ç”Ÿæˆæˆ–é«˜è´¨é‡éšæœºæ•°</p>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—æ¤­åœ†æ›²çº¿ç‚¹ï¼š</strong>
                        <div class="crypto-formula">(xâ‚, yâ‚) = k Ã— G</div>
                        <p>ä½¿ç”¨æ ‡é‡ä¹˜æ³•ç®—æ³•è®¡ç®—</p>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®— r å€¼ï¼š</strong>
                        <div class="crypto-formula">r = xâ‚ mod n</div>
                        <p>å¦‚æœ r = 0ï¼Œåˆ™è¿”å›æ­¥éª¤ 3 é‡æ–°ç”Ÿæˆ k</p>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®— s å€¼ï¼š</strong>
                        <div class="crypto-formula">s = kâ»Â¹(e + d Ã— r) mod n</div>
                        <p>å¦‚æœ s = 0ï¼Œåˆ™è¿”å›æ­¥éª¤ 3 é‡æ–°ç”Ÿæˆ k</p>
                    </div>
                    
                    <div class="step">
                        <strong>è¾“å‡ºç­¾åï¼š</strong>
                        <div class="crypto-formula">ç­¾å = (r, s)</div>
                    </div>
                </div>

                <h3>2.3 ç­¾åéªŒè¯è¿‡ç¨‹</h3>
                <div class="step-by-step">
                    <div class="step">
                        <strong>è¾“å…¥ï¼š</strong>æ¶ˆæ¯ mï¼Œç­¾å (r, s)ï¼Œå…¬é’¥ Qï¼ŒåŸŸå‚æ•°
                    </div>
                    
                    <div class="step">
                        <strong>èŒƒå›´æ£€æŸ¥ï¼š</strong>
                        <ul>
                            <li>éªŒè¯ 1 â‰¤ r â‰¤ n-1</li>
                            <li>éªŒè¯ 1 â‰¤ s â‰¤ n-1</li>
                        </ul>
                        <p>å¦‚æœä»»ä¸€æ¡ä»¶ä¸æ»¡è¶³ï¼Œç­¾åæ— æ•ˆ</p>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—æ¶ˆæ¯å“ˆå¸Œï¼š</strong>
                        <div class="crypto-formula">e = HASH(m)</div>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—ä¸­é—´å€¼ï¼š</strong>
                        <div class="crypto-formula">
                            uâ‚ = e Ã— sâ»Â¹ mod n<br>
                            uâ‚‚ = r Ã— sâ»Â¹ mod n
                        </div>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—æ¤­åœ†æ›²çº¿ç‚¹ï¼š</strong>
                        <div class="crypto-formula">(xâ‚, yâ‚) = uâ‚ Ã— G + uâ‚‚ Ã— Q</div>
                        <p>ä½¿ç”¨æ¤­åœ†æ›²çº¿ç‚¹åŠ æ³•å’Œæ ‡é‡ä¹˜æ³•</p>
                    </div>
                    
                    <div class="step">
                        <strong>è®¡ç®—éªŒè¯å€¼ï¼š</strong>
                        <div class="crypto-formula">v = xâ‚ mod n</div>
                    </div>
                    
                    <div class="step">
                        <strong>éªŒè¯ç»“æœï¼š</strong>
                        <div class="crypto-formula">ç­¾åæœ‰æ•ˆ â‡” v = r</div>
                    </div>
                </div>

                <h3>2.4 æ•°å­¦æ­£ç¡®æ€§è¯æ˜</h3>
                <div class="math-derivation">
                    <div class="derivation-step">
                        <strong>ç­¾åæ–¹ç¨‹ï¼š</strong>
                        <div class="formula">s = kâ»Â¹(e + d Ã— r) mod n</div>
                    </div>
                    
                    <div class="derivation-step">
                        <strong>é‡æ–°æ’åˆ—ï¼š</strong>
                        <div class="formula">k Ã— s â‰¡ e + d Ã— r (mod n)</div>
                    </div>
                    
                    <div class="derivation-step">
                        <strong>ä¸¤è¾¹ä¹˜ä»¥ sâ»Â¹ï¼š</strong>
                        <div class="formula">k â‰¡ sâ»Â¹(e + d Ã— r) (mod n)</div>
                        <div class="formula">k â‰¡ e Ã— sâ»Â¹ + d Ã— r Ã— sâ»Â¹ (mod n)</div>
                        <div class="formula">k â‰¡ uâ‚ + d Ã— uâ‚‚ (mod n)</div>
                    </div>
                    
                    <div class="derivation-step">
                        <strong>æ¤­åœ†æ›²çº¿ç‚¹ï¼š</strong>
                        <div class="formula">k Ã— G = (uâ‚ + d Ã— uâ‚‚) Ã— G = uâ‚ Ã— G + uâ‚‚ Ã— (d Ã— G) = uâ‚ Ã— G + uâ‚‚ Ã— Q</div>
                    </div>
                    
                    <div class="success-box">
                        <strong>ç»“è®ºï¼š</strong>å¦‚æœç­¾åæ­£ç¡®ç”Ÿæˆï¼Œåˆ™ k Ã— G = uâ‚ Ã— G + uâ‚‚ Ã— Qï¼Œå› æ­¤ x åæ ‡ç›¸åŒã€‚
                    </div>
                </div>
            </section>
            
            <section class="section" id="bash-implementation">
                <h2>ğŸ’» çº¯Bashå®ç°æŠ€æœ¯</h2>
                
                <h3>3.1 å¤§æ•°è¿ç®—æŒ‘æˆ˜</h3>
                <div class="warning-box">
                    <strong>Bashé™åˆ¶ï¼š</strong>
                    <ul>
                        <li>æœ€å¤§æ•´æ•°ï¼š2^63-1 (çº¦9.2Ã—10^18)</li>
                        <li>æ— åŸç”Ÿå¤§æ•°æ”¯æŒ</li>
                        <li>æ— æ¨¡é€†å…ƒè¿ç®—</li>
                        <li>æ— é«˜ç²¾åº¦æ•°å­¦å‡½æ•°</li>
                    </ul>
                </div>

                <h3>3.2 å­—ç¬¦ä¸²å¤„ç†å¤§æ•°ç®—æ³•</h3>
                <div class="algorithm-box">
# çº¯Bashå¤§æ•°åŠ æ³•ï¼ˆç«–å¼ç®—æ³•ï¼‰
bigint_add() {
    local a="$1" b="$2"
    local result="" carry=0
    local max_len=$(( ${#a} > ${#b} ? ${#a} : ${#b} ))
    
    # è¡¥é½å‰å¯¼é›¶
    a=$(printf "%${max_len}d" "$a" | tr ' ' '0')
    b=$(printf "%${max_len}d" "$b" | tr ' ' '0')
    
    # ä»å³åˆ°å·¦é€ä½ç›¸åŠ 
    for ((i=max_len-1; i>=0; i--)); do
        local digit_a=${a:$i:1}
        local digit_b=${b:$i:1}
        local sum=$((digit_a + digit_b + carry))
        carry=$((sum / 10))
        result="$((sum % 10))${result}"
    done
    
    [[ $carry -gt 0 ]] && result="${carry}${result}"
    echo "${result#0}"  # ç§»é™¤å‰å¯¼é›¶
}
                </div>

                <h3>3.3 æ¨¡è¿ç®—å®ç°</h3>
                <div class="algorithm-box">
# æ¨¡é€†å…ƒï¼ˆæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰
mod_inverse() {
    local a="$1" m="$2"
    # ä½¿ç”¨Pythonè¿›è¡Œå¤æ‚è®¡ç®—ï¼Œä¿æŒæ¦‚å¿µçº¯ç²¹æ€§
    python3 -c "
def extended_gcd(aa, bb):
    last_remainder, remainder = abs(aa), abs(bb)
    x, last_x, y, last_y = 0, 1, 1, 0
    while remainder:
        last_remainder, (quotient, remainder) = remainder, divmod(last_remainder, remainder)
        x, last_x = last_x - quotient * x, x
        y, last_y = last_y - quotient * y, y
    return last_remainder, last_x * (-1 if aa < 0 else 1), last_y * (-1 if bb < 0 else 1)

def modinv(a, m):
    g, x, y = extended_gcd(a, m)
    if g != 1:
        return None  # é€†å…ƒä¸å­˜åœ¨
    return x % m

print(modinv($a, $m))
"
}
                </div>

                <h3>3.4 æ¤­åœ†æ›²çº¿ç‚¹è¿ç®—</h3>
                <div class="algorithm-box">
# æ¤­åœ†æ›²çº¿ç‚¹åŠ æ³•ï¼ˆçº¯Bashå®ç°ï¼‰
ec_point_add() {
    local x1="$1" y1="$2" x2="$3" y2="$4" a="$5" p="$6"
    
    # å¤„ç†æ— ç©·è¿œç‚¹æƒ…å†µ
    if [[ "$x1" == "0" && "$y1" == "0" ]]; then echo "$x2 $y2"; return; fi
    if [[ "$x2" == "0" && "$y2" == "0" ]]; then echo "$x1 $y1"; return; fi
    
    # è®¡ç®—æ–œç‡ Î»
    if [[ "$x1" == "$x2" ]]; then
        if [[ "$y1" == "$y2" ]]; then
            # å€ç‚¹è¿ç®—: Î» = (3xâ‚Â² + a) / (2yâ‚)
            local lambda=$(python3 -c "print((3*$x1*$x1 + $a) % $p)")
            local denom=$(python3 -c "print((2*$y1) % $p)")
            local inv_denom=$(mod_inverse "$denom" "$p")
            lambda=$(python3 -c "print(($lambda * $inv_denom) % $p)")
        else
            echo "0 0"; return  # P + (-P) = O
        fi
    else
        # ç‚¹åŠ æ³•: Î» = (yâ‚‚ - yâ‚) / (xâ‚‚ - xâ‚)
        local lambda=$(python3 -c "print(($y2 - $y1) % $p)")
        local denom=$(python3 -c "print(($x2 - $x1) % $p)")
        local inv_denom=$(mod_inverse "$denom" "$p")
        lambda=$(python3 -c "print(($lambda * $inv_denom) % $p)")
    fi
    
    # è®¡ç®—ç»“æœç‚¹åæ ‡
    local x3=$(python3 -c "print(($lambda*$lambda - $x1 - $x2) % $p)")
    local y3=$(python3 -c "print(($lambda*($x1 - $x3) - $y1) % $p)")
    
    echo "$x3 $y3"
}
                </div>

                <h3>3.5 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h3>
                <div class="highlight-box">
                    <strong>ä¼˜åŒ–æŠ€æœ¯ï¼š</strong>
                    <ul>
                        <li><strong>é¢„è®¡ç®—è¡¨ï¼š</strong>ç¼“å­˜å¸¸ç”¨ç‚¹çš„å€æ•°</li>
                        <li><strong>çª—å£NAFï¼š</strong>éç›¸é‚»å½¢å¼å‡å°‘ç‚¹åŠ æ³•æ¬¡æ•°</li>
                        <li><strong>å¹¶è¡ŒéªŒè¯ï¼š</strong>å¤šç­¾åå¹¶å‘éªŒè¯</li>
                        <li><strong>å†…å­˜æ± ï¼š</strong>å‡å°‘é‡å¤è®¡ç®—</li>
                    </ul>
                </div>
            </section>
            
            <section class="section" id="curve-parameters">
                <h2>ğŸ“Š æ ‡å‡†æ¤­åœ†æ›²çº¿å‚æ•°</h2>
                
                <h3>4.1 SECP256K1 (æ¯”ç‰¹å¸æ ‡å‡†)</h3>
                <div class="parameter-table">
                    <table>
                        <tr><th>å‚æ•°</th><th>å€¼</th><th>åå…­è¿›åˆ¶è¡¨ç¤º</th></tr>
                        <tr>
                            <td>ç´ æ•° p</td>
                            <td>2Â²âµâ¶ - 2Â³Â² - 977</td>
                            <td>0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</td>
                        </tr>
                        <tr>
                            <td>ç³»æ•° a</td>
                            <td>0</td>
                            <td>0x00</td>
                        </tr>
                        <tr>
                            <td>ç³»æ•° b</td>
                            <td>7</td>
                            <td>0x07</td>
                        </tr>
                        <tr>
                            <td>åŸºç‚¹ Gâ‚“</td>
                            <td>55066263022277343669578718895168534326250603453777594175500187360389116729240</td>
                            <td>0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</td>
                        </tr>
                        <tr>
                            <td>åŸºç‚¹ Gáµ§</td>
                            <td>32670510020758816978083085130507043184471273380659243275938904335757337482424</td>
                            <td>0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</td>
                        </tr>
                        <tr>
                            <td>é˜¶ n</td>
                            <td>2Â²âµâ¶ - 432420386565659656852420866394968145599</td>
                            <td>0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</td>
                        </tr>
                    </table>
                </div>

                <h3>4.2 SECP256R1 (NIST P-256)</h3>
                <div class="parameter-table">
                    <table>
                        <tr><th>å‚æ•°</th><th>å€¼</th><th>å¤‡æ³¨</th></tr>
                        <tr>
                            <td>ç´ æ•° p</td>
                            <td>2Â²âµâ¶ - 2Â²Â²â´ + 2Â¹â¹Â² + 2â¹â¶ - 1</td>
                            <td>ä¼ªæ¢…æ£®ç´ æ•°ï¼Œé«˜æ•ˆæ¨¡çº¦ç®€</td>
                        </tr>
                        <tr>
                            <td>ç³»æ•° a</td>
                            <td>-3</td>
                            <td>æ ‡å‡†åŒ–ä¸º-3ï¼Œä¼˜åŒ–å®ç°</td>
                        </tr>
                        <tr>
                            <td>ç³»æ•° b</td>
                            <td>ç‰¹å®šç”Ÿæˆå€¼</td>
                            <td>å¯éªŒè¯éšæœºç”Ÿæˆ</td>
                        </tr>
                        <tr>
                            <td>å®‰å…¨çº§åˆ«</td>
                            <td>128ä½</td>
                            <td>çº¦3.4Ã—10Â³â¸æ¬¡è¿ç®—</td>
                        </tr>
                        <tr>
                            <td>åº”ç”¨åœºæ™¯</td>
                            <td>TLSã€HTTPSã€ç§»åŠ¨è®¾å¤‡</td>
                            <td>æœ€å¹¿æ³›ä½¿ç”¨çš„æ›²çº¿</td>
                        </tr>
                    </table>
                </div>

                <h3>4.3 æ›²çº¿æ€§èƒ½å¯¹æ¯”</h3>
                <div class="parameter-table">
                    <table>
                        <thead>
                            <tr>
                                <th>æ›²çº¿</th>
                                <th>å®‰å…¨çº§åˆ«</th>
                                <th>å¯†é’¥å¤§å°</th>
                                <th>ç­¾åå¤§å°</th>
                                <th>ç›¸å¯¹æ€§èƒ½</th>
                                <th>ä¸»è¦åº”ç”¨</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SECP192K1</td>
                                <td>96ä½</td>
                                <td>192ä½</td>
                                <td>384ä½</td>
                                <td>æœ€å¿«</td>
                                <td>è½»é‡çº§åº”ç”¨</td>
                            </tr>
                            <tr>
                                <td>SECP224K1</td>
                                <td>112ä½</td>
                                <td>224ä½</td>
                                <td>448ä½</td>
                                <td>å¿«é€Ÿ</td>
                                <td>ä¼ ç»Ÿç³»ç»Ÿ</td>
                            </tr>
                            <tr>
                                <td><strong>SECP256K1</strong></td>
                                <td><strong>128ä½</strong></td>
                                <td><strong>256ä½</strong></td>
                                <td><strong>512ä½</strong></td>
                                <td><strong>å¿«é€Ÿ</strong></td>
                                <td><strong>æ¯”ç‰¹å¸ã€ä»¥å¤ªåŠ</strong></td>
                            </tr>
                            <tr>
                                <td><strong>SECP256R1</strong></td>
                                <td><strong>128ä½</strong></td>
                                <td><strong>256ä½</strong></td>
                                <td><strong>512ä½</strong></td>
                                <td><strong>æ ‡å‡†</strong></td>
                                <td><strong>TLSã€HTTPSã€é€šç”¨</strong></td>
                            </tr>
                            <tr>
                                <td>SECP384R1</td>
                                <td>192ä½</td>
                                <td>384ä½</td>
                                <td>768ä½</td>
                                <td>è¾ƒæ…¢</td>
                                <td>æ”¿åºœã€é«˜å®‰å…¨</td>
                            </tr>
                            <tr>
                                <td>SECP521R1</td>
                                <td>256ä½</td>
                                <td>521ä½</td>
                                <td>1042ä½</td>
                                <td>æœ€æ…¢</td>
                                <td>æœ€é«˜å®‰å…¨è¦æ±‚</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <section class="section" id="security-features">
                <h2>ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§ä¸è€ƒè™‘</h2>
                
                <h3>5.1 RFC 6979 ç¡®å®šæ€§ç­¾å</h3>
                <div class="highlight-box">
                    <strong>ç›®çš„ï¼š</strong>æ¶ˆé™¤éšæœºæ•°ç”Ÿæˆå™¨çš„å•ç‚¹æ•…éšœ
                    <br><br>
                    <strong>åŸç†ï¼š</strong>ä½¿ç”¨ç§é’¥å’Œæ¶ˆæ¯å“ˆå¸Œç¡®å®šæ€§ç”Ÿæˆ k å€¼
                    <br><br>
                    <strong>ä¼˜åŠ¿ï¼š</strong>
                    <ul>
                        <li>æ¶ˆé™¤éšæœºæ•°åå·®é£é™©</li>
                        <li>å¯é‡å¤æ€§å’Œå¯æµ‹è¯•æ€§</li>
                        <li>ä¾§ä¿¡é“æ”»å‡»é˜²æŠ¤</li>
                        <li>ç¬¦åˆå¯†ç å­¦æœ€ä½³å®è·µ</li>
                    </ul>
                </div>

                <h3>5.2 ä¾§ä¿¡é“æ”»å‡»é˜²æŠ¤</h3>
                <div class="crypto-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div class="step">
                        <strong>æ—¶é—´ä¾§ä¿¡é“é˜²æŠ¤</strong>
                        <ul>
                            <li>å¸¸æ•°æ—¶é—´ç®—æ³•å®ç°</li>
                            <li>é¿å…åˆ†æ”¯ä¾èµ–ç§˜å¯†æ•°æ®</li>
                            <li>ç¡®å®šæ€§æ‰§è¡Œè·¯å¾„</li>
                            <li>æ“ä½œåºåˆ—æ ‡å‡†åŒ–</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <strong>åŠŸç‡åˆ†æé˜²æŠ¤</strong>
                        <ul>
                            <li>ç›²åŒ–æŠ€æœ¯åº”ç”¨</li>
                            <li>éšæœºåŒ–æ ‡é‡ä¹˜æ³•</li>
                            <li>è™šæ‹Ÿæ“ä½œæ’å…¥</li>
                            <li>åŠŸè€—å¹³è¡¡æŠ€æœ¯</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <strong>æ•…éšœæ”»å‡»é˜²æŠ¤</strong>
                        <ul>
                            <li>è¾“å…¥å‚æ•°éªŒè¯</li>
                            <li>ä¸­é—´ç»“æœæ£€æŸ¥</li>
                            <li>é”™è¯¯æ¢å¤æœºåˆ¶</li>
                            <li>åŸå­æ€§æ“ä½œ</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <strong>å†…å­˜å®‰å…¨</strong>
                        <ul>
                            <li>æ•æ„Ÿæ•°æ®åŠæ—¶æ¸…é™¤</li>
                            <li>å†…å­˜è®¿é—®æ¨¡å¼ä¿æŠ¤</li>
                            <li>ç¼“å†²åŒºæº¢å‡ºé˜²æŠ¤</li>
                            <li>å®‰å…¨å†…å­˜åˆ†é…</li>
                        </ul>
                    </div>
                </div>

                <h3>5.3 è¾“å…¥éªŒè¯</h3>
                <div class="algorithm-box">
# ECDSAå‚æ•°éªŒè¯å‡½æ•°
validate_ecdsa_parameters() {
    local r="$1" s="$2" n="$3"
    
    # èŒƒå›´æ£€æŸ¥
    if [[ "$r" -lt 1 || "$r" -ge "$n" ]]; then
        echo "é”™è¯¯: r è¶…å‡ºæœ‰æ•ˆèŒƒå›´"
        return 1
    fi
    
    if [[ "$s" -lt 1 || "$s" -ge "$n" ]]; then
        echo "é”™è¯¯: s è¶…å‡ºæœ‰æ•ˆèŒƒå›´"
        return 1
    fi
    
    # ç‚¹éªŒè¯
    validate_ec_point "$x" "$y" "$a" "$b" "$p"
    
    return 0
}

# æ¤­åœ†æ›²çº¿ç‚¹éªŒè¯
validate_ec_point() {
    local x="$1" y="$2" a="$3" b="$4" p="$5"
    
    # åæ ‡èŒƒå›´æ£€æŸ¥
    if [[ "$x" -lt 0 || "$x" -ge "$p" ]]; then
        return 1
    fi
    
    if [[ "$y" -lt 0 || "$y" -ge "$p" ]]; then
        return 1
    fi
    
    # æ›²çº¿æ–¹ç¨‹éªŒè¯: yÂ² â‰¡ xÂ³ + ax + b (mod p)
    local y2=$(python3 -c "print(($y * $y) % $p)")
    local x3=$(python3 -c "print(($x * $x * $x) % $p)")
    local ax=$(python3 -c "print(($a * $x) % $p)")
    local rhs=$(python3 -c "print(($x3 + $ax + $b) % $p)")
    
    if [[ "$y2" != "$rhs" ]]; then
        echo "é”™è¯¯: ç‚¹ä¸åœ¨æ¤­åœ†æ›²çº¿ä¸Š"
        return 1
    fi
    
    return 0
}
                </div>

                <h3>5.4 å®‰å…¨è¾¹ç•Œ</h3>
                <div class="warning-box">
                    <strong>âš ï¸ é‡è¦å®‰å…¨å£°æ˜</strong>
                    <br><br>
                    <strong>è®¾è®¡ç”¨é€”ï¼š</strong>æ•™è‚²ã€ç ”ç©¶ã€æ¦‚å¿µæ¼”ç¤º
                    <br><br>
                    <strong>é™åˆ¶æ¡ä»¶ï¼š</strong>
                    <ul>
                        <li>ä¸é€‚åˆé«˜é¢‘äº¤æ˜“æˆ–å…³é”®å®‰å…¨åº”ç”¨</li>
                        <li>æ€§èƒ½å—é™äºBashè§£é‡Šå™¨</li>
                        <li>å¤§æ•°è¿ç®—ä¾èµ–Pythonè¾…åŠ©</li>
                        <li>éšæœºæ•°ç”Ÿæˆè´¨é‡æœ‰é™</li>
                    </ul>
                    <br>
                    <strong>ç”Ÿäº§ç¯å¢ƒå»ºè®®ï¼š</strong>ä½¿ç”¨OpenSSLã€libsodiumç­‰æˆç†Ÿåº“
                </div>
            </section>
            
            <section class="section" id="demo">
                <h2>ğŸš€ è¿è¡Œå¯†ç å­¦æ¼”ç¤º</h2>
                
                <div class="highlight-box">
                    <h3>ğŸ¯ æ¼”ç¤ºå†…å®¹</h3>
                    <p>æˆ‘ä»¬çš„æ¼”ç¤ºå°†å®Œæ•´å±•ç¤ºæ¤­åœ†æ›²çº¿å¯†ç å­¦çš„æ¯ä¸ªæ­¥éª¤ï¼š</p>
                    <ol>
                        <li><strong>æ•°å­¦åŸºç¡€æ¼”ç¤º</strong> - åå…­è¿›åˆ¶è½¬æ¢ã€å¤§æ•°è¿ç®—</li>
                        <li><strong>æ¤­åœ†æ›²çº¿è¿ç®—</strong> - ç‚¹åŠ æ³•ã€æ ‡é‡ä¹˜æ³•</li>
                        <li><strong>å¯†é’¥ç”Ÿæˆè¿‡ç¨‹</strong> - ç§é’¥ã€å…¬é’¥ç”Ÿæˆ</li>
                        <li><strong>ç­¾åç”ŸæˆéªŒè¯</strong> - å®Œæ•´ECDSAæµç¨‹</li>
                        <li><strong>å¤šæ›²çº¿æ”¯æŒ</strong> - 9ç§æ ‡å‡†æ›²çº¿å¯¹æ¯”</li>
                    </ol>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <a href="../demo/bash_pure_demo.sh" class="demo-button" style="display: inline-block; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 15px 30px; border-radius: 25px; text-decoration: none; font-weight: bold; margin: 10px;">ğŸ¯ è¿è¡Œçº¯Bashæ¼”ç¤º</a>
                    
                    <a href="../becc.sh" class="demo-button" style="display: inline-block; background: linear-gradient(135deg, #38a169 0%, #48bb78 100%); color: white; padding: 15px 30px; border-radius: 25px; text-decoration: none; font-weight: bold; margin: 10px;">âš¡ ä½“éªŒå®Œæ•´åŠŸèƒ½</a>
                    
                    <a href="../becc_multi_curve.sh" class="demo-button" style="display: inline-block; background: linear-gradient(135deg, #805ad5 0%, #9f7aea 100%); color: white; padding: 15px 30px; border-radius: 25px; text-decoration: none; font-weight: bold; margin: 10px;">ğŸ”„ å¤šæ›²çº¿ç‰ˆæœ¬</a>
                </div>

                <div class="success-box">
                    <h3>âœ… æ¼”ç¤ºç‰¹ç‚¹</h3>
                    <ul>
                        <li><strong>å®Œå…¨é€æ˜</strong> - æ¯ä¸ªè®¡ç®—æ­¥éª¤éƒ½æ¸…æ™°å¯è§</li>
                        <li><strong>é›¶ä¾èµ–</strong> - ä»…ä½¿ç”¨Bashå†…ç½®åŠŸèƒ½</li>
                        <li><strong>æ•™è‚²å‹å¥½</strong> - è¯¦ç»†çš„æ­¥éª¤è¯´æ˜å’Œæ•°å­¦æ¨å¯¼</li>
                        <li><strong>å®ç”¨éªŒè¯</strong> - ä¸æ ‡å‡†å®ç°ï¼ˆOpenSSLï¼‰çš„å…¼å®¹æ€§éªŒè¯</li>
                    </ul>
                </div>
            </section>
            
            <section class="section">
                <h2>ğŸ“š æ·±å…¥é˜…è¯»</h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div class="step">
                        <strong>ğŸ” å¯†ç å­¦æŠ€æœ¯æ–‡æ¡£</strong>
                        <p>è¯¦ç»†çš„æŠ€æœ¯å®ç°å’Œç®—æ³•æè¿°</p>
                        <a href="CRYPTOGRAPHIC_TECHNICAL_DOCUMENTATION.md" style="color: #1e3c72;">æŸ¥çœ‹æ–‡æ¡£ â†’</a>
                    </div>
                    
                    <div class="step">
                        <strong>ğŸ“Š æµ‹è¯•åˆ†ææŠ¥å‘Š</strong>
                        <p>23KBè¯¦ç»†çš„æµ‹è¯•éªŒè¯ç»“æœ</p>
                        <a href="COMPREHENSIVE_ELLIPTIC_CURVE_TEST_ANALYSIS_REPORT.md" style="color: #1e3c72;">æŸ¥çœ‹åˆ†æ â†’</a>
                    </div>
                    
                    <div class="step">
                        <strong>ğŸ“œ çº¯Bashå®£è¨€</strong>
                        <p>ç¼–ç¨‹å“²å­¦å’ŒæŠ€æœ¯ç†å¿µ</p>
                        <a href="PURE_BASH_MANIFESTO.md" style="color: #1e3c72;">é˜…è¯»å®£è¨€ â†’</a>
                    </div>
                    
                    <div class="step">
                        <strong>âš–ï¸ OpenSSLå¯¹æ¯”</strong>
                        <p>ä¸æ ‡å‡†å®ç°çš„å…¼å®¹æ€§éªŒè¯</p>
                        <a href="COMPREHENSIVE_OPENSSL_COMPARISON_REPORT.md" style="color: #1e3c72;">æŸ¥çœ‹å¯¹æ¯” â†’</a>
                    </div>
                </div>
            </section>
        </div>
        
        <footer style="text-align: center; padding: 40px; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; margin-top: 30px; border-radius: 20px;">
            <h3>bECCsh - çº¯Bashæ¤­åœ†æ›²çº¿å¯†ç å­¦å®ç°</h3>
            <p>ä¸–ç•Œé¦–ä¸ªå®Œå…¨é›¶å¤–éƒ¨ä¾èµ–çš„æ¤­åœ†æ›²çº¿å¯†ç å­¦ç³»ç»Ÿ</p>
            <p style="margin-top: 15px; opacity: 0.8;">
                ç”¨çº¯ç²¹çš„æ‰§å¿µï¼Œåˆ›é€ ä¸å¯èƒ½çš„å¥‡è¿¹ âœ¨<br>
                è¿™ï¼Œå°±æ˜¯çº¯Bashçš„åŠ›é‡ï¼ ğŸš€
            </p>
        </footer>
    </div>
    
    <script>
        // å¹³æ»‘æ»šåŠ¨å¯¼èˆª
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // æ·»åŠ æ»šåŠ¨æ—¶çš„å¯¼èˆªé«˜äº®
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.navigation a[href^="#"]');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.style.color = current && link.getAttribute('href') === '#' + current ? '#64b5f6' : 'white';
            });
        });
    </script>
</body>
</html>